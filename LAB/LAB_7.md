## Лабораторная работа № 7. Настройка Политики паролей и Политики блокировки учётной записи в Active Directory


### Цель работы
Освоить настройку политик безопасности Active Directory через групповые политики (GPO):  
* политики паролей (длина, сложность, срок действия);  
* политики блокировки учётных записей (пороговое значение, длительность, сброс счётчика).

### Теоретические сведения

**Групповые политики (GPO)** — механизм централизованного управления настройками в доменах Windows. Применяются к пользователям и компьютерам через организационные единицы (OU).

**Основные политики безопасности:**

1. **Политика паролей** (в разделе *Computer Configuration → Policies → Windows Settings → Security Settings → Account Policies → Password Policy*):
   * **Минимальная длина пароля** (`Minimum password length`) — не менее 8 символов (рекомендовано).
   * **Сложность пароля** (`Password must meet complexity requirements`) — требует сочетания: заглавных/строчных букв, цифр, специальных символов.
   * **Срок действия пароля** (`Maximum password age`) — максимум 90 дней (рекомендовано).
   * **История паролей** (`Enforce password history`) — запоминание последних 5–24 паролей.

2. **Политика блокировки учётных записей** (в разделе *Account Policies → Account Lockout Policy*):
   * **Пороговое значение блокировки** (`Account lockout threshold`) — число неудачных попыток (например, 3–5).
   * **Длительность блокировки** (`Account lockout duration`) — время блокировки (например, 30 мин).
   * **Сброс счётчика блокировки** (`Reset account lockout counter after`) — через сколько минут счётчик обнуляется (должно быть ≤ `Account lockout duration`).

**Важно:** Политики паролей и блокировки применяются только к учётным записям домена Active Directory.

### Оборудование и ПО
* Виртуальная машина 1: Windows Server (с установленным роли **Доменные службы Active Directory**).
* Виртуальная машина 2: Windows 10 (член домена).
* Гипервизор (VMware, VirtualBox, Hyper‑V).

### Ход работы

#### 1. Подготовка инфраструктуры
1. Разверните две виртуальные машины:
   * VM1: Windows Server (роль AD DS установлена, домен создан, например, `lab.local`).
   * VM2: Windows 10 (присоединена к домену `lab.local`).
2. На сервере:
   * Откройте **Диспетчер серверов** → **Средства** → **Active Directory — пользователи и компьютеры**.
   * Создайте OU (организационный подраздел), например, **LabUsers**.
   * В OU **LabUsers** создайте 2–3 тестовые учётные записи пользователей (например, `user1`, `user2`).

#### 2. Создание и настройка GPO
1. На Windows Server откройте **Редактор управления групповыми политиками** (`gpmc.msc`).
2. Создайте новый GPO:
   * Щёлкните правой кнопкой по OU **LabUsers** → **Создать объект групповой политики…**
   * Назовите, например, **Lab_Password_Lockout_Policy**.
3. Свяжите GPO с OU:
   * Перетащите GPO на OU **LabUsers** или выберите **Связать существующий GPO…** в контекстном меню OU.
4. Отредактируйте GPO:
   * Щёлкните по GPO → **Изменить**.
   * Перейдите: **Computer Configuration → Policies → Windows Settings → Security Settings → Account Policies**.

#### 3. Настройка Политики паролей
1. В разделе **Password Policy** измените параметры:
   * **Minimum password length**: $8$ символов.
   * **Password must meet complexity requirements**: **Включено**.
   * **Maximum password age**: $90$ дней.
   * **Enforce password history**: запомнить последние $5$ паролей.
2. Подтвердите изменения (OK).

#### 4. Настройка Политики блокировки учётных записей
1. В разделе **Account Lockout Policy** измените параметры:
   * **Account lockout threshold**: $3$ неудачные попытки.
   * **Account lockout duration**: $30$ минут.
   * **Reset account lockout counter after**: $15$ минут.
2. Подтвердите изменения (OK).

#### 5. Применение политик и проверка
1. На сервере принудительно обновите политики:
   * Откройте командную строку (от имени администратора).
   * Выполните:  
     ```
     gpupdate /force
     ```
2. На клиенте (Windows 10):
   * Войдите под доменной учётной записью (например, `user1`).
   * Откройте командную строку и выполните:  
     ```
     gpupdate /force
     ```
   * Либо перезагрузите машину.

#### 6. Тестирование политик
1. Проверка политики паролей:
   * Попробуйте сменить пароль на короткий (менее 8 символов) — система должна запретить.
   * Попробуйте задать пароль без цифр/специальных символов (если включена сложность) — система должна запретить.
2. Проверка политики блокировки:
   * На клиенте попытайтесь войти под учётной записью `user1` с неверным паролем $3$ раза подряд.
   * После $3$-й попытки учётная запись должна заблокироваться.
   * Подождите $15$ минут (сброс счётчика) и попробуйте снова — система должна разрешить вход.
   * Проверьте состояние учётной записи на сервере:  
     * В **Active Directory — пользователи и компьютеры** щёлкните по `user1` → **Свойства** → вкладка **Учётная запись**.  
     * Поле **Заблокирована** должно быть отмечено.

#### 7. Дополнительные настройки (по желанию)
1. Настройка аудита событий:
   * В GPO перейдите: **Computer Configuration → Policies → Windows Settings → Security Settings → Advanced Audit Policy Configuration**.
   * Включите аудит **Account Logon** и **Account Management**.
2. Настройка уведомлений о смене пароля:
   * Используйте скрипты или сторонние средства для отправки email-уведомлений перед истечением срока действия пароля.

### Контрольные вопросы
1. Какие параметры входят в Политику паролей? Приведите примеры рекомендуемых значений.
2. Что такое «история паролей» и зачем она нужна?
3. Как связаны параметры **Account lockout threshold**, **Account lockout duration** и **Reset account lockout counter after**?
4. Почему политики паролей и блокировки не применяются к локальным учётным записям?
5. Как принудительно обновить групповые политики на клиенте?

### Отчёт по работе
Предоставьте:
1. Скриншот консоли **gpmc.msc** с созданным GPO **Lab_Password_Lockout_Policy**.
2. Скриншот настроек **Password Policy** и **Account Lockout Policy** в редакторе GPO.
3. Скриншот свойств учётной записи `user1` после блокировки (вкладка **Учётная запись**).
4. Описание возникших проблем и способов их решения (если были).
5. Ответы на контрольные вопросы.

### Вывод
В ходе лабораторной работы освоена настройка политик безопасности Active Directory через GPO:  
* заданы требования к длине, сложности и сроку действия паролей;  
* настроены параметры блокировки учётных записей при неудачных попытках входа.  
Проведено тестирование политик, подтверждены их работоспособность и влияние на безопасность домена.